<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Code Prettier - 코드 변환 도구</title>
  <meta name="description" content="기존 코드를 새로운 코드로 변환하고 차이점을 시각적으로 확인할 수 있는 도구">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
  <link rel="stylesheet" href="assets/css/common.css">
  <link rel="stylesheet" href="assets/css/site-ui.css">
  
  <style>
    .prettier-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .prettier-header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
    }
    
    .prettier-header h1 {
      margin: 0 0 10px 0;
      font-size: 2.2em;
    }
    
    .prettier-header p {
      margin: 0;
      opacity: 0.9;
      font-size: 1.1em;
    }
    
    .prettier-main {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .code-panel {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .panel-header {
      background: #f8f9fa;
      padding: 15px 20px;
      border-bottom: 1px solid #e9ecef;
      font-weight: 600;
      color: #495057;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .panel-header .badge {
      background: #007bff;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: normal;
    }
    
    .code-textarea {
      width: 100%;
      height: 400px;
      border: none;
      padding: 20px;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.5;
      resize: vertical;
      background: #fafafa;
      color: #333;
      box-sizing: border-box;
    }
    
    .code-textarea:focus {
      outline: none;
      background: white;
    }
    
    .transform-controls {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #495057;
    }
    
         .control-group input {
       width: 100%;
       padding: 8px 12px;
       border: 1px solid #ced4da;
       border-radius: 4px;
       font-size: 14px;
       box-sizing: border-box;
     }
    
    .control-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-primary {
      background: #007bff;
      color: white;
    }
    
    .btn-primary:hover {
      background: #0056b3;
    }
    
    .btn-success {
      background: #28a745;
      color: white;
    }
    
    .btn-success:hover {
      background: #1e7e34;
    }
    
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    
    .btn-secondary:hover {
      background: #545b62;
    }
    
    .diff-panel {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .diff-content {
      padding: 20px;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      max-height: 500px;
      overflow-y: auto;
    }
    
    .diff-line {
      padding: 2px 0;
      margin: 0;
    }
    
    .diff-added {
      background: #d4edda;
      color: #155724;
      padding: 2px 8px;
      margin: 1px 0;
      border-left: 3px solid #28a745;
    }
    
    .diff-removed {
      background: #f8d7da;
      color: #721c24;
      padding: 2px 8px;
      margin: 1px 0;
      border-left: 3px solid #dc3545;
      text-decoration: line-through;
    }
    
    .diff-unchanged {
      color: #6c757d;
      padding: 2px 8px;
    }
    
    .result-panel {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .result-content {
      padding: 20px;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      background: #f8f9fa;
      max-height: 500px;
      overflow-y: auto;
      border-radius: 0 0 8px 8px;
    }
    
    .comment-highlight {
      background: #fff3cd;
      border-left: 3px solid #ffc107;
      padding: 2px 4px;
      margin: 1px 0;
    }
    
    .preset-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    
         .btn-preset {
       padding: 8px 16px;
       background: #f8f9fa;
       border: none;
       border-radius: 6px;
       font-size: 13px;
       font-weight: 600;
       color: #495057;
       cursor: pointer;
       transition: all 0.2s ease;
       box-shadow: 0 2px 4px rgba(0,0,0,0.1);
     }
     
     .btn-preset:hover {
       background: #007bff;
       color: white;
       transform: translateY(-1px);
       box-shadow: 0 4px 8px rgba(0,123,255,0.3);
     }
    
    .stats {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
      font-size: 14px;
      color: #6c757d;
    }
    
    .stat-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .stat-number {
      font-weight: 600;
      color: #007bff;
    }
    
         /* 플로팅 버튼 - index.html 빠른 도입 버튼과 동일한 스타일 */
     .floating-vimeo-btn {
       position: fixed;
       right: 2.2rem;
       bottom: 2.2rem;
       z-index: 1200;
       display: flex;
       align-items: center;
       gap: 0.6em;
       background: #1976d2;
       color: #fff;
       border: none;
       border-radius: 2em;
       box-shadow: 0 2px 12px 0 #1976d233;
       padding: 0.7em 1.4em;
       font-size: 1.08em;
       font-weight: 500;
       cursor: pointer;
       transition: background 0.18s, box-shadow 0.18s;
     }
     
     .floating-vimeo-btn:hover, 
     .floating-vimeo-btn:focus {
       background: #1565c0;
       box-shadow: 0 4px 16px 0 #1976d244;
     }

     @media (max-width: 768px) {
       .prettier-main {
         grid-template-columns: 1fr;
       }
       
       .control-buttons {
         justify-content: center;
       }
       
       .preset-buttons {
         justify-content: center;
       }
       
       /* 사용 예시 반응형 */
       .usage-examples [style*="grid-template-columns: 1fr 1fr"] {
         display: block !important;
       }
       
       .usage-examples [style*="grid-template-columns: 1fr 1fr"] > div:first-child {
         margin-bottom: 20px;
       }
     }

     @media (max-width: 600px) {
       .floating-vimeo-btn {
         right: 1rem;
         bottom: 1rem;
         font-size: 0.98em;
         padding: 0.6em 1em;
       }
     }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="header-center">
        <div class="logo">
          <a href="index.html">
            <img src="assets/images/logo.png" alt="Adapt Style Guide">
          </a>
        </div>
      </div>
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">메인 데모</a></li>
          <li><a href="custom-guide.html">커스텀 엘리먼트 가이드</a></li>
          <li><a href="code-prettier.html" class="active">Code Prettier</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="prettier-container">
    <div class="transform-controls">
      <div class="preset-buttons">
        <button class="btn-preset" onclick="setPreset('selective')">🎯 선택적 변경</button>
        <button class="btn-preset" onclick="setPreset('date')">📅 날짜 변경</button>
        <button class="btn-preset" onclick="setPreset('image')">📷 이미지 경로 변경</button>
      </div>
      
      <!-- 정규식 패턴 설명 -->
      <div style="background: #e3f2fd; padding: 12px 16px; border-radius: 6px; margin-bottom: 15px; border-left: 4px solid #1976d2;">
        <div style="font-size: 14px; color: #333; margin-bottom: 8px;"><strong>💡 정규식 패턴 설명</strong></div>
        <div style="font-family: monospace; font-size: 13px; color: #555;">
          <div><strong>찾을 텍스트:</strong> <code>/250617\/(01|02|03|04)\.(jpg|png)/g</code></div>
          <div style="margin-top: 6px; color: #333;"><strong>바꿀 텍스트 예시:</strong> <code>250701</code</div>
          <div style="margin: 8px 0; font-size: 12px; color: #666;">
            <span style="background: #fff3e0; padding: 2px 6px; border-radius: 3px;">$1 = 파일번호 (01|02|03|04)</span> 
            <span style="background: #fff3e0; padding: 2px 6px; border-radius: 3px; margin-left: 8px;">$2 = 확장자 (jpg|png)</span>
          </div>
        </div>
      </div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 24px;">
        <div class="control-group">
          <label for="findText">찾을 텍스트 (정규식 지원)</label>
          <input type="text" id="findText" placeholder="예: /250617\/(23|25)\.(jpg|png)/g" autocomplete="off" />
        </div>
        <div class="control-group">
          <label for="replaceText">바꿀 텍스트</label>
          <input type="text" id="replaceText" placeholder="예: 250701" autocomplete="off" />
        </div>
      </div>
      
      <div class="control-group">
        <label for="commentText">주석 내용 (선택사항)</label>
        <input type="text" id="commentText" placeholder="예: 특정 이미지만 날짜 변경" autocomplete="off" />
      </div>
      
      <div class="control-buttons">
        <button class="btn btn-primary" onclick="transformCode()">
          🔄 코드 변환
        </button>
        <button class="btn btn-secondary" onclick="clearAll()">
          🗑️ 전체 초기화
        </button>
        <button class="btn btn-success" onclick="copyResult()" id="copyBtn" style="display: none;">
          📋 결과 복사
        </button>
      </div>
    </div>

    <div class="prettier-main">
      <div class="code-panel">
        <div class="panel-header">
          기존 코드
          <span class="badge">Original</span>
        </div>
        <textarea 
          class="code-textarea" 
          id="originalCode" 
          placeholder="기존 코드를 여기에 붙여넣으세요...&#10;&#10;예시:&#10;<img src='/images/old/logo.png' alt='로고'>&#10;<div class='old-class'>내용</div>"
        ></textarea>
      </div>
      
      <div class="code-panel">
        <div class="panel-header">
          새로운 코드
          <span class="badge" style="background: #28a745;">Modified</span>
        </div>
        <textarea 
          class="code-textarea" 
          id="newCode" 
          placeholder="변환된 코드가 여기에 표시됩니다..."
          readonly
        ></textarea>
      </div>
    </div>

    <div class="diff-panel">
      <div class="panel-header">
        변경점 비교
        <div class="stats" id="diffStats" style="display: none;">
          <div class="stat-item">
            <span style="color: #28a745;">➕</span>
            <span class="stat-number" id="addedLines">0</span>
            <span>추가</span>
          </div>
          <div class="stat-item">
            <span style="color: #dc3545;">➖</span>
            <span class="stat-number" id="removedLines">0</span>
            <span>삭제</span>
          </div>
        </div>
      </div>
      <div class="diff-content" id="diffContent">
        여기에서 변경점을 확인할 수 있습니다.
      </div>
    </div>

    <div class="result-panel">
      <div class="panel-header">
        최종 결과 (주석 포함)
        <button class="btn btn-success btn-sm" onclick="copyResult()" style="padding: 5px 10px; font-size: 12px;">
          📋 복사
        </button>
      </div>
      <div class="result-content" id="resultContent">
        변환 후 주석이 추가된 최종 코드가 여기에 표시됩니다.
      </div>
    </div>

    <!-- 사용 예시 섹션 -->
    <div class="usage-examples" style="margin-top: 40px;">
      <div class="panel-header" style="background: #f8f9fa; padding: 20px; border-radius: 8px 8px 0 0; border-bottom: 1px solid #e9ecef;">
        <h3 style="margin: 0; color: #495057;">📖 사용 예시</h3>
      </div>
      
      <div style="background: white; border-radius: 0 0 8px 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 30px;">
        <!-- 예시 1: 선택적 변경 -->
        <div class="example-section" style="margin-bottom: 40px;">
          <h4 style="color: #007bff; margin-bottom: 15px;">🎯 선택적 변경 예시</h4>
          <p style="color: #666; margin-bottom: 20px;">23번과 25번 이미지만 날짜를 250617에서 250701로 변경하는 경우</p>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <div>
              <h5 style="color: #dc3545; margin-bottom: 10px;">❌ 변경 전</h5>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; font-family: monospace; font-size: 13px; border-left: 3px solid #dc3545;">
<span style="color: #666;">&lt;div class="product_detail_wrap"&gt;</span>
  &lt;img src="/img/detail/P000000L/<span style="background: #ffebee; color: #c62828;">250617</span>/22.jpg"&gt;
  &lt;img src="/img/detail/P000000L/<span style="background: #ffebee; color: #c62828;">250617</span>/23.jpg"&gt;
  &lt;img src="/img/detail/P000000L/<span style="background: #ffebee; color: #c62828;">250617</span>/24.jpg"&gt;
  &lt;img src="/img/detail/P000000L/<span style="background: #ffebee; color: #c62828;">250617</span>/25.jpg"&gt;
<span style="color: #666;">&lt;/div&gt;</span>
              </div>
            </div>
            
            <div>
              <h5 style="color: #28a745; margin-bottom: 10px;">✅ 변경 후</h5>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; font-family: monospace; font-size: 13px; border-left: 3px solid #28a745;">
<span style="color: #666;">&lt;div class="product_detail_wrap"&gt;</span>
  &lt;img src="/img/detail/P000000L/250617/22.jpg"&gt;
  &lt;img src="/img/detail/P000000L/<span style="background: #e8f5e8; color: #2e7d32;">250701</span>/23.jpg"&gt; <span style="color: #ff9800;">/* 250701 - 특정 이미지만 날짜 변경 */</span>
  &lt;img src="/img/detail/P000000L/250617/24.jpg"&gt;
  &lt;img src="/img/detail/P000000L/<span style="background: #e8f5e8; color: #2e7d32;">250701</span>/25.jpg"&gt; <span style="color: #ff9800;">/* 250701 - 특정 이미지만 날짜 변경 */</span>
<span style="color: #666;">&lt;/div&gt;</span>
              </div>
            </div>
          </div>
          
          <div style="background: #e3f2fd; padding: 15px; border-radius: 6px; border-left: 4px solid #1976d2;">
            <h6 style="margin: 0 0 10px 0; color: #1976d2;">⚙️ 설정값</h6>
            <div style="font-family: monospace; font-size: 13px; color: #333;">
              <div><strong>찾을 텍스트:</strong> <code>/250617\/(23|25)\.(jpg|png)/g</code></div>
              <div><strong>바꿀 텍스트:</strong> <code>250701/$1.$2</code></div>
              <div><strong>주석 내용:</strong> <code>특정 이미지만 날짜 변경</code></div>
            </div>
          </div>
        </div>

        <!-- 사용 팁 -->
        <div class="usage-tips" style="background: #fff3e0; padding: 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
          <h4 style="color: #f57c00; margin: 0 0 15px 0;">💡 사용 팁</h4>
          <ul style="margin: 0; padding-left: 20px; color: #333;">
            <li style="margin-bottom: 8px;"><strong>정규식 활용:</strong> 복잡한 패턴은 정규식으로 처리 (예: <code>/old\d+/g</code>)</li>
            <li style="margin-bottom: 8px;"><strong>백업 필수:</strong> 대량 변경 전에는 반드시 원본 코드를 백업하세요</li>
            <li style="margin-bottom: 8px;"><strong>단계별 테스트:</strong> 작은 부분부터 테스트 후 전체 적용</li>
            <li style="margin-bottom: 8px;"><strong>주석 활용:</strong> 변경 내용을 명확히 기록해 추후 추적 가능</li>
            <li><strong>미리보기 확인:</strong> 변환 결과를 반드시 확인 후 복사</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- 플로팅 비메오 버튼 -->
  <button class="floating-vimeo-btn" onclick="document.getElementById('vimeoGeneratorModal').open()" title="비메오 코드 생성기">
    <span>비메오 코드 생성기</span>
  </button>

  <!-- 비메오 코드 생성기 모달 -->
  <site-modal id="vimeoGeneratorModal">
    <div class="modal-header">
      <h3>🎬 비메오 코드 생성기</h3>
      <button class="usage-guide-close" onclick="document.getElementById('vimeoGeneratorModal').close()" aria-label="닫기">&times;</button>
    </div>
    <div class="modal-body">
      <!-- 사용법 가이드 -->
      <div class="vimeo-guide" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 24px; border-left: 4px solid #007bff;">
        <h4 style="margin: 0 0 10px 0; color: #007bff; font-size: 16px;">📋 비메오 다이렉트 링크 가져오는 방법</h4>
        <div class="guide-steps" style="font-size: 14px; line-height: 1.6; display: none;">
          <p style="margin: 8px 0;"><strong>1.</strong> 라이브러리에서 동영상을 엽니다</p>
          <p style="margin: 8px 0;"><strong>2.</strong> 동영상 설정 페이지의 오른쪽 상단 모서리에 있는 <strong>옵션 메뉴 (…)</strong>를 선택합니다</p>
          <p style="margin: 8px 0;"><strong>3.</strong> <strong>Video file links</strong>를 선택합니다</p>
          <p style="margin: 8px 0;"><strong>4.</strong> 모달 창의 드롭다운 메뉴에서 <strong>Play The Video</strong>를 선택합니다</p>
          <p style="margin: 8px 0;"><strong>5.</strong> 가져오려는 화질의 <strong>Copy Link</strong>를 선택합니다</p>
          <p style="margin: 8px 0;"><strong>6.</strong> 복사된 링크를 아래 입력창에 붙여넣기하고 코드를 생성하세요</p>
        </div>
        <button onclick="toggleVimeoGuide()" style="background: none; border: none; color: #007bff; cursor: pointer; font-size: 12px; margin-top: 5px; text-decoration: underline;">
          가이드 펼치기
        </button>
      </div>
      
      <div class="vimeo-generator">
        <label for="vimeoUrl">비메오 링크를 붙여넣으세요:</label>
        <input type="url" id="vimeoUrl" placeholder="https://player.vimeo.com/progressive_redirect/playback/..." autocomplete="off" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
        
        <div class="vimeo-options">
          <label style="display: flex; align-items: center; margin: 10px 0;">
            <input type="checkbox" id="vimeoMuted" checked style="margin-right: 8px;">
            음소거 (muted)
          </label>
          <label style="display: flex; align-items: center; margin: 10px 0;">
            <input type="checkbox" id="vimeoAutoplay" checked style="margin-right: 8px;">
            자동재생 (autoplay)
          </label>
          <label style="display: flex; align-items: center; margin: 10px 0;">
            <input type="checkbox" id="vimeoLoop" checked style="margin-right: 8px;">
            반복재생 (loop)
          </label>
          <label style="display: flex; align-items: center; margin: 10px 0;">
            <input type="checkbox" id="vimeoPlaysinline" checked style="margin-right: 8px;">
            인라인 재생 (playsinline)
          </label>
        </div>
        
        <button onclick="generateVimeoCode()" style="width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 4px; margin: 10px 0; cursor: pointer;">
          HTML 코드 생성
        </button>
        
        <div class="generated-code" style="display: none;">
          <label>생성된 HTML 코드:</label>
          <textarea id="generatedCode" readonly style="width: 100%; height: 120px; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 14px; background: #f8f9fa; box-sizing: border-box;"></textarea>
          <button onclick="copyGeneratedCode()" style="width: 100%; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
            📋 코드 복사
          </button>
        </div>
      </div>
    </div>
  </site-modal>

  <script>
    // 프리셋 설정
    function setPreset(type) {
      const findInput = document.getElementById('findText');
      const replaceInput = document.getElementById('replaceText');
      const commentInput = document.getElementById('commentText');
      
      const presets = {
        selective: {
          find: '/250617\\/(23|25)\\.(jpg|png)/g',
          replace: '250701/$1.$2',
          comment: '특정 이미지만 날짜 변경'
        },
        date: {
          find: '250617',
          replace: '250701',
          comment: '이미지 날짜 업데이트'
        },
        image: {
          find: '/images/',
          replace: '/assets/images/',
          comment: '이미지 경로 업데이트'
        }
      };
      
      if (presets[type]) {
        findInput.value = presets[type].find;
        replaceInput.value = presets[type].replace;
        commentInput.value = presets[type].comment;
      }
    }

    // 코드 변환 함수
    function transformCode() {
      const originalCode = document.getElementById('originalCode').value;
      const findText = document.getElementById('findText').value;
      const replaceText = document.getElementById('replaceText').value;
      const commentText = document.getElementById('commentText').value;
      
      if (!originalCode.trim()) {
        alert('기존 코드를 입력해주세요.');
        return;
      }
      
      if (!findText.trim()) {
        alert('찾을 텍스트를 입력해주세요.');
        return;
      }
      
      // 정규식 처리
      let regex;
      try {
        if (findText.startsWith('/') && findText.lastIndexOf('/') > 0) {
          const flags = findText.substring(findText.lastIndexOf('/') + 1);
          const pattern = findText.substring(1, findText.lastIndexOf('/'));
          regex = new RegExp(pattern, flags || 'g');
        } else {
          regex = new RegExp(findText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
        }
      } catch (e) {
        alert('정규식 패턴이 올바르지 않습니다.');
        return;
      }
      
      // 코드 변환
      const newCode = originalCode.replace(regex, replaceText);
      document.getElementById('newCode').value = newCode;
      
      // 차이점 표시
      showDiff(originalCode, newCode);
      
      // 주석 추가된 최종 결과 생성
      generateFinalResult(originalCode, newCode, findText, replaceText, commentText);
      
      // 복사 버튼 표시
      document.getElementById('copyBtn').style.display = 'inline-flex';
    }

    // 차이점 표시 함수
    function showDiff(original, modified) {
      const originalLines = original.split('\n');
      const modifiedLines = modified.split('\n');
      const diffContent = document.getElementById('diffContent');
      const diffStats = document.getElementById('diffStats');
      
      let html = '';
      let addedCount = 0;
      let removedCount = 0;
      
      const maxLines = Math.max(originalLines.length, modifiedLines.length);
      
      for (let i = 0; i < maxLines; i++) {
        const originalLine = originalLines[i] || '';
        const modifiedLine = modifiedLines[i] || '';
        
        if (originalLine === modifiedLine) {
          if (originalLine.trim()) {
            html += `<div class="diff-line diff-unchanged">${escapeHtml(originalLine)}</div>`;
          }
        } else {
          if (originalLine && originalLines[i] !== undefined) {
            html += `<div class="diff-line diff-removed">- ${escapeHtml(originalLine)}</div>`;
            removedCount++;
          }
          if (modifiedLine && modifiedLines[i] !== undefined) {
            html += `<div class="diff-line diff-added">+ ${escapeHtml(modifiedLine)}</div>`;
            addedCount++;
          }
        }
      }
      
      diffContent.innerHTML = html || '변경사항이 없습니다.';
      
      // 통계 업데이트
      document.getElementById('addedLines').textContent = addedCount;
      document.getElementById('removedLines').textContent = removedCount;
      diffStats.style.display = addedCount > 0 || removedCount > 0 ? 'flex' : 'none';
    }

    // 최종 결과 생성 (주석 포함)
    function generateFinalResult(original, modified, findText, replaceText, commentText) {
      const today = '250701'; // 오늘 날짜
      const lines = modified.split('\n');
      const originalLines = original.split('\n');
      let result = '';
      
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        const originalLine = originalLines[i] || '';
        
        // 변경된 라인인지 확인
        if (line !== originalLine && line.includes(replaceText)) {
          const comment = commentText ? 
            ` /* ${today} - ${commentText} */` : 
            ` /* ${today} - ${findText} → ${replaceText} */`;
          
          // HTML 태그인지 확인
          if (line.trim().startsWith('<') && line.trim().endsWith('>')) {
            // HTML 태그의 경우 <!-- --> 주석 사용
            result += line + `\n<!-- ${today} - ${commentText || findText + ' → ' + replaceText} -->\n`;
          } else {
            // 일반 코드의 경우 /* */ 주석 사용
            result += line + comment + '\n';
          }
        } else {
          result += line + '\n';
        }
      }
      
      const resultContent = document.getElementById('resultContent');
      resultContent.innerHTML = `<div class="comment-highlight">${escapeHtml(result)}</div>`;
    }

    // HTML 이스케이프 함수
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // 결과 복사 함수
    function copyResult() {
      const resultContent = document.getElementById('resultContent').textContent;
      
      if (!resultContent.trim()) {
        alert('복사할 내용이 없습니다.');
        return;
      }
      
      navigator.clipboard.writeText(resultContent).then(() => {
        const copyBtn = document.getElementById('copyBtn');
        const originalText = copyBtn.innerHTML;
        copyBtn.innerHTML = '✅ 복사됨!';
        copyBtn.style.background = '#28a745';
        
        setTimeout(() => {
          copyBtn.innerHTML = originalText;
          copyBtn.style.background = '#28a745';
        }, 2000);
      }).catch(() => {
        // 클립보드 API가 지원되지 않는 경우
        const textArea = document.createElement('textarea');
        textArea.value = resultContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        alert('클립보드에 복사되었습니다!');
      });
    }

    // 전체 초기화 함수
    function clearAll() {
      if (confirm('모든 내용을 초기화하시겠습니까?')) {
        document.getElementById('originalCode').value = '';
        document.getElementById('newCode').value = '';
        document.getElementById('findText').value = '';
        document.getElementById('replaceText').value = '';
        document.getElementById('commentText').value = '';
        document.getElementById('diffContent').innerHTML = '여기에서 변경점을 확인할 수 있습니다.';
        document.getElementById('resultContent').innerHTML = '변환 후 주석이 추가된 최종 코드가 여기에 표시됩니다.';
        document.getElementById('diffStats').style.display = 'none';
        document.getElementById('copyBtn').style.display = 'none';
      }
    }

    // 실시간 미리보기 (옵션)
    document.getElementById('originalCode').addEventListener('input', function() {
      const findText = document.getElementById('findText').value;
      const replaceText = document.getElementById('replaceText').value;
      
      if (this.value && findText && replaceText) {
        // 자동 변환은 사용자가 원할 때만 활성화
        // transformCode();
      }
    });

    // 바꿀 텍스트 자동 완성 기능
    document.getElementById('replaceText').addEventListener('input', function() {
      const findText = document.getElementById('findText').value;
      const replaceText = this.value;
      
      // 찾을 텍스트가 정규식 패턴이고, 바꿀 텍스트가 간단한 형태일 때 자동 완성
      if (findText.includes('/(') && findText.includes('|') && findText.includes(')\\.(') && replaceText && !replaceText.includes('$')) {
        // 현재 커서 위치 저장
        const cursorPos = this.selectionStart;
        const originalLength = replaceText.length;
        
        // $1.$2가 없고 단순한 텍스트만 있는 경우
        if (!replaceText.includes('$1') && !replaceText.includes('$2')) {
          const newValue = replaceText + '/$1.$2';
          this.value = newValue;
          
          // 커서를 추가된 텍스트 앞에 위치시킴 (사용자가 입력한 부분 끝)
          this.setSelectionRange(originalLength, originalLength);
        }
      }
    });

  </script>

  <script src="assets/js/common.js" defer></script>
  <script src="assets/js/site-ui.js" defer></script>
</body>
</html> 